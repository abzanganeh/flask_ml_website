<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block meta_description %}{{ site_title }} - Professional AI/ML Engineer and Data Scientist{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}machine learning, artificial intelligence, data science, python, flask, portfolio{% endblock %}">
    <meta name="author" content="Alireza Barzin Zanganeh">
    <link rel="canonical" href="{% block canonical_url %}{{ canonical_url or request.base_url }}{% endblock %}">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{{ site_title }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Professional ML Engineer specializing in Machine Learning, Deep Learning, and Data Science{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:image" content="{{ url_for('static', filename='images/og-image.jpg') }}">
    
    <title>{% block title %}{{ site_title }}{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/apple-touch-icon.png') }}">
    
    <!-- CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/main.css') }}?v=2" rel="stylesheet">
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
    {% block extra_css %}{% endblock %}

    {% block structured_data %}
        {% if request.endpoint == 'blog_post' and post %}
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            "headline": "{{ post.title|e }}",
            "description": "{{ post.meta_description|e }}",
            "datePublished": "{{ post.created_at.isoformat() }}",
            "author": {
                "@type": "Person",
                "name": "{{ post.author|e }}"
            },
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": "{{ canonical_url or request.base_url }}"
            }
        }
        </script>
        {% elif request.endpoint == 'tutorial_detail' and tutorial %}
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "TechArticle",
            "headline": "{{ tutorial.title|e }}",
            "description": "{{ tutorial.description|e }}",
            "datePublished": "{{ tutorial.created_at.isoformat() if tutorial.created_at else current_year }}",
            "author": {
                "@type": "Person",
                "name": "Alireza Barzin Zanganeh"
            },
            "proficiencyLevel": "{{ tutorial.difficulty|default('Intermediate') }}",
            "timeRequired": "PT{{ tutorial.duration|default('60') }}M"
        }
        </script>
        {% endif %}
    {% endblock %}

    <!-- Notification Styles -->
    <style>
    .notification-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        max-width: 400px;
    }
    
    .notification {
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        margin-bottom: 10px;
        overflow: hidden;
        animation: slideIn 0.3s ease-out;
    }
    
    .notification-success {
        border-left: 4px solid #4CAF50;
    }
    
    .notification-error {
        border-left: 4px solid #f44336;
    }
    
    .notification-warning {
        border-left: 4px solid #ff9800;
    }
    
    .notification-info {
        border-left: 4px solid #2196F3;
    }
    
    .notification-content {
        padding: 16px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .notification-message {
        flex: 1;
        margin: 0;
        color: #333;
    }
    
    .notification-close {
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: #666;
        margin-left: 10px;
    }
    
    .notification-close:hover {
        color: #333;
    }
    
    @keyframes slideIn {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }
    </style>
    
</head>
<body class="{% block body_class %}{% endblock %}">
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="{{ url_for('index') }}">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" style="height: 40px;">
                    <span class="logo-text"></span>
                    <span class="logo-subtitle">ML/DS</span>
                </a>
            </div>
            
            <!-- Search Form -->
            <div class="nav-search">
                <form action="{{ url_for('search') }}" method="GET" class="search-form">
                    <div class="search-input-group">
                        <input type="text" name="q" placeholder="Search tutorials, projects..." class="search-input" value="{{ request.args.get('q', '') }}">
                        <button type="submit" class="search-button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="nav-menu" id="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-link {% if request.endpoint == 'index' %}active{% endif %}">
                    <i class="fas fa-home"></i> Home
                </a>
                <a href="{{ url_for('about') }}" class="nav-link {% if request.endpoint == 'about' %}active{% endif %}">
                    <i class="fas fa-user"></i> About
                </a>
                <a href="{{ url_for('projects') }}" class="nav-link {% if request.endpoint == 'projects' or request.endpoint == 'project_detail' %}active{% endif %}">
                    <i class="fas fa-code"></i> Projects
                </a>
                <a href="{{ url_for('tutorials') }}" class="nav-link {% if request.endpoint == 'tutorials' or request.endpoint == 'tutorial_detail' %}active{% endif %}">
                    <i class="fas fa-book"></i> Tutorials
                </a>
                <a href="{{ url_for('blog') }}" class="nav-link {% if request.endpoint in ['blog', 'blog_post', 'blog_category'] %}active{% endif %}">
                    <i class="fas fa-edit"></i> Blog
                </a>
                <a href="{{ url_for('contact') }}" class="nav-link {% if request.endpoint == 'contact' %}active{% endif %}">
                    <i class="fas fa-envelope"></i> Contact
                </a>
            </div>
            
            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}" role="alert">
                            <span class="alert-message">{{ message }}</span>
                            <button type="button" class="alert-close" onclick="this.parentElement.remove()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Alireza Barzin Zanganeh</h3>
                    <p>ML Engineer & Data Scientist</p>
                    <p>Passionate about creating intelligent solutions through machine learning and data science.</p>
                </div>
                
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="{{ url_for('projects') }}">Projects</a></li>
                        <li><a href="{{ url_for('tutorials') }}">Tutorials</a></li>
                        <li><a href="{{ url_for('blog') }}">Blog</a></li>
                        <li><a href="{{ url_for('contact') }}">Contact</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="{{ social_links.linkedin }}" target="_blank" rel="noopener" aria-label="LinkedIn">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="{{ social_links.github }}" target="_blank" rel="noopener" aria-label="GitHub">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="mailto:{{ social_links.email }}" aria-label="Email">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <div class="footer-navigation">
                <button id="footer-back-to-top" class="footer-nav-btn" onclick="scrollToTop()" aria-label="Back to top">
                    <i class="fas fa-arrow-up"></i> Back to Top
                </button>
                <button class="footer-nav-btn" onclick="scrollToNavigation()" aria-label="Go to navigation">
                    <i class="fas fa-bars"></i> Main Navigation
                </button>
                {% block footer_navigation %}
                    {% if request.endpoint == 'tutorial_detail' or request.endpoint == 'tutorials' %}
                        <a href="{{ url_for('tutorials') }}" class="footer-nav-btn">
                            <i class="fas fa-book"></i> All Tutorials
                        </a>
                        <a href="{{ url_for('projects') }}" class="footer-nav-btn">
                            <i class="fas fa-code"></i> View Projects
                        </a>
                    {% elif request.endpoint == 'project_detail' or request.endpoint == 'projects' %}
                        <a href="{{ url_for('projects') }}" class="footer-nav-btn">
                            <i class="fas fa-code"></i> All Projects
                        </a>
                        <a href="{{ url_for('tutorials') }}" class="footer-nav-btn">
                            <i class="fas fa-book"></i> View Tutorials
                        </a>
                    {% elif request.endpoint == 'blog_post' or request.endpoint == 'blog' %}
                        <a href="{{ url_for('blog') }}" class="footer-nav-btn">
                            <i class="fas fa-edit"></i> All Posts
                        </a>
                        <a href="{{ url_for('tutorials') }}" class="footer-nav-btn">
                            <i class="fas fa-book"></i> Tutorials
                        </a>
                    {% else %}
                        <a href="{{ url_for('projects') }}" class="footer-nav-btn">
                            <i class="fas fa-code"></i> View Projects
                        </a>
                        <a href="{{ url_for('tutorials') }}" class="footer-nav-btn">
                            <i class="fas fa-book"></i> View Tutorials
                        </a>
                    {% endif %}
                    <a href="{{ url_for('contact') }}" class="footer-nav-btn">
                        <i class="fas fa-envelope"></i> Get in Touch
                    </a>
                {% endblock %}
            </div>
            
            <div class="footer-bottom">
                <p>&copy; {{ current_year }} Alireza Barzin Zanganeh. All rights reserved.</p>
                <p>Built using Flask/Python</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top" aria-label="Back to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main-python.js') }}"></script>
    <!-- KaTeX for math rendering -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: "$$", right: "$$", display: true},
                        {left: "\\[", right: "\\]", display: true},
                        {left: "$", right: "$", display: false},
                        {left: "\\(", right: "\\)", display: false}
                    ]
                });
            }
        });
    </script>
    {% if google_analytics_id %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ google_analytics_id }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ google_analytics_id }}');
    </script>
    {% endif %}
    {% if plausible_domain %}
    <script defer data-domain="{{ plausible_domain }}" src="{{ plausible_api_host }}/js/script.js"></script>
    {% endif %}
    {% block extra_js %}{% endblock %}
    
    <!-- Search Modal -->
    <div id="search-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search</h3>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <input type="text" id="search-input" placeholder="Search tutorials and projects..." autocomplete="off">
                <div id="search-results"></div>
            </div>
        </div>
    </div>
</body>
</html>

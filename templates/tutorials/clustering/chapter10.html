<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 10: Dendrogram Construction and Interpretation - Comprehensive Clustering Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/tutorials/clustering/clustering.css') }}">
    <script src="{{ url_for('static', filename='js/tutorials/clustering/shared-tutorial.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tutorials/clustering/shared-quiz.js') }}"></script>
    <script src="{{ url_for('static', filename='js/tutorials/clustering/chapter10.js') }}"></script>
</head>
<body>
    <header class="azbn-header">
        <nav class="azbn-nav">
            <div class="azbn-container">
                <a href="/tutorials/clustering" class="course-link">
                    <span>Comprehensive Clustering Analysis</span>
                </a>
                <div class="azbn-links">
                    <a href="/">Home</a>
                    <a href="/#about">About</a>
                    <a href="/tutorials/">Tutorials</a>
                    <a href="/#projects">Projects</a>
                    <a href="/contact">Contact</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <!-- Tutorial Header -->
        <div class="tutorial-header">
            <div class="azbn-container">
                <h1 class="chapter-title">Chapter 10: Dendrogram Construction and Interpretation</h1>
                <p class="chapter-subtitle">Master dendrograms as mathematical trees for hierarchical clustering, from construction algorithms to interpretation and validation techniques</p>
                
                <!-- Chapter Progress Bar (10/15) -->
                <div class="chapter-progress">
                    <div class="chapter-progress-fill" data-progress="66.67"></div>
                </div>
                
                <!-- Chapter Navigation (All 15 chapters) -->
                <div class="chapter-navigation">
                    <a href="/tutorials/clustering/chapter1" class="chapter-nav-btn">Chapter 1</a>
                    <a href="/tutorials/clustering/chapter2" class="chapter-nav-btn">Chapter 2</a>
                    <a href="/tutorials/clustering/chapter3" class="chapter-nav-btn">Chapter 3</a>
                    <a href="/tutorials/clustering/chapter4" class="chapter-nav-btn">Chapter 4</a>
                    <a href="/tutorials/clustering/chapter5" class="chapter-nav-btn">Chapter 5</a>
                    <a href="/tutorials/clustering/chapter6" class="chapter-nav-btn">Chapter 6</a>
                    <a href="/tutorials/clustering/chapter7" class="chapter-nav-btn">Chapter 7</a>
                    <a href="/tutorials/clustering/chapter8" class="chapter-nav-btn">Chapter 8</a>
                    <a href="/tutorials/clustering/chapter9" class="chapter-nav-btn">Chapter 9</a>
                    <a href="/tutorials/clustering/chapter10" class="chapter-nav-btn active">Chapter 10</a>
                    <a href="/tutorials/clustering/chapter11" class="chapter-nav-btn">Chapter 11</a>
                    <a href="/tutorials/clustering/chapter12" class="chapter-nav-btn">Chapter 12</a>
                    <a href="/tutorials/clustering/chapter13" class="chapter-nav-btn">Chapter 13</a>
                    <a href="/tutorials/clustering/chapter14" class="chapter-nav-btn">Chapter 14</a>
                    <a href="/tutorials/clustering/chapter15" class="chapter-nav-btn">Chapter 15</a>
                </div>
                
                <!-- Section Progress Bar -->
                <div class="section-progress">
                    <div class="section-progress-fill" data-progress="14.29"></div>
                </div>
                
                <!-- Section Navigation -->
                <div class="section-nav">
                    <button class="section-nav-btn active" data-section="introduction">Introduction</button>
                    <button class="section-nav-btn" data-section="construction">Construction</button>
                    <button class="section-nav-btn" data-section="heights">Heights</button>
                    <button class="section-nav-btn" data-section="cutting">Cutting</button>
                    <button class="section-nav-btn" data-section="validation">Validation</button>
                    <button class="section-nav-btn" data-section="visualization">Visualization</button>
                    <button class="section-nav-btn" data-section="interpretation">Interpretation</button>
                    <button class="section-nav-btn" data-section="interactive">Interactive Demo</button>
                    <button class="section-nav-btn" data-section="quiz">Quiz</button>
                </div>
            </div>
        </div>

        <section class="azbn-section">
            <div class="azbn-container">
                <!-- Learning Objectives -->
                <div class="learning-objectives-box">
                    <h2>Learning Objectives</h2>
                    <ul>
                        <li>Understand the K-means algorithm step-by-step process</li>
                        <li>Master the mathematical foundations and objective function</li>
                        <li>Learn different initialization methods and their impact</li>
                        <li>Analyze convergence properties and stopping criteria</li>
                        <li>Implement K-means from scratch with interactive demos</li>
                        <li>Compare different distance metrics in K-means clustering</li>
                        <li>Evaluate clustering quality using various metrics</li>
                    </ul>
                </div>

                <!-- Main Content Area -->
                <main class="chapter-main-content">
                    <!-- Introduction Section -->
                    <div id="introduction" class="content-section active">
                        <h2>Dendrograms: Mathematical Trees for Hierarchical Structure</h2>
                        
                        <p>Dendrograms serve as the primary visualization and data structure for representing hierarchical clustering results. More than just visual aids, they are mathematical objects with rich theoretical properties that encode the complete clustering hierarchy in a tree structure. Understanding their construction, interpretation, and validation is essential for effective hierarchical clustering analysis.</p>

                        <h3>Mathematical Definition and Structure</h3>
                        <p>A dendrogram is fundamentally a rooted binary tree with specific mathematical properties that encode clustering relationships.</p>

                        <div class="explanation-box">
                            <h4>Formal Definition of Dendrograms</h4>
                            
                            <h5>Tree Structure:</h5>
                            <div class="white-box">
                                <p>A dendrogram T for n data points is a rooted binary tree where:</p>
                                <ul class="small-list">
                                    <li><strong>Leaves:</strong> n nodes corresponding to individual data points</li>
                                    <li><strong>Internal nodes:</strong> n-1 nodes representing cluster merges</li>
                                    <li><strong>Root:</strong> Single node representing the cluster containing all points</li>
                                    <li><strong>Height function:</strong> h: Internal nodes → ℝ⁺ assigning merge heights</li>
                                </ul>
                            </div>
                            
                            <h5>Mathematical Properties:</h5>
                            <div class="white-box">
                                <p><strong>Monotonicity:</strong> For any internal node v with parent p:</p>
                                <div class="centered-text">
                                    <strong>h(v) ≤ h(p)</strong>
                                </div>
                                <p>Heights increase (or stay constant) moving toward the root.</p>
                                
                                <p><strong>Leaf heights:</strong> h(leaf) = 0 for all leaf nodes</p>
                                
                                <p><strong>Ultrametric property:</strong> The distance between any two leaves equals the height of their lowest common ancestor.</p>
                            </div>
                            
                            <h5>Encoding Information:</h5>
                            <ul>
                                <li><strong>Clustering hierarchy:</strong> Tree structure shows nested cluster relationships</li>
                                <li><strong>Merge order:</strong> Order in which clusters were combined</li>
                                <li><strong>Merge distances:</strong> Heights indicate dissimilarity at merge points</li>
                                <li><strong>Cluster relationships:</strong> Closer branches indicate more similar clusters</li>
                            </ul>
                        </div>

                        <h3>Types of Dendrograms</h3>
                        <p>Different clustering algorithms and distance metrics produce dendrograms with varying characteristics and interpretations.</p>

                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Dendrogram Type</th>
                                    <th>Source Algorithm</th>
                                    <th>Height Interpretation</th>
                                    <th>Special Properties</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Single Linkage</strong></td>
                                    <td>Minimum spanning tree</td>
                                    <td>Minimum distance between clusters</td>
                                    <td>May have many ties at same height</td>
                                </tr>
                                <tr>
                                    <td><strong>Complete Linkage</strong></td>
                                    <td>Maximum distance criterion</td>
                                    <td>Maximum distance within merged cluster</td>
                                    <td>Monotonic height increases</td>
                                </tr>
                                <tr>
                                    <td><strong>Average Linkage</strong></td>
                                    <td>UPGMA algorithm</td>
                                    <td>Average distance between clusters</td>
                                    <td>Balanced tree structure</td>
                                </tr>
                                <tr>
                                    <td><strong>Ward's Method</strong></td>
                                    <td>Variance minimization</td>
                                    <td>Increase in within-cluster variance</td>
                                    <td>Statistical interpretation</td>
                                </tr>
                                <tr>
                                    <td><strong>Centroid Linkage</strong></td>
                                    <td>Centroid distance</td>
                                    <td>Distance between cluster centroids</td>
                                    <td>May violate monotonicity</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Dendrogram Anatomy</h4>
                            <p><strong>Image Description:</strong> A detailed anatomical diagram of a dendrogram showing a binary tree for 8 data points. The diagram labels key components: leaf nodes (data points A-H), internal nodes (merge points), height axis (y-axis showing merge distances), branches connecting nodes, root node at top. Annotations show how to read merge order, cluster relationships, and height interpretations. A horizontal cutting line demonstrates how different cut heights yield different numbers of clusters.</p>
                            <p><em>This shows the fundamental structure and components of dendrograms as mathematical objects</em></p>
                        </div>

                        <div class="theorem-box">
                            <h3>Information Content and Complexity</h3>
                            <p>Dendrograms encode significant information about the clustering process and dataset structure.</p>

                            <div class="tree-structure">
                                <h4>Information Theoretic Analysis</h4>
                                
                                <h5>Structural Information:</h5>
                                <ul>
                                    <li><strong>Tree topology:</strong> 2ⁿ⁻¹ possible binary tree shapes for n leaves</li>
                                    <li><strong>Height assignments:</strong> Real-valued heights at n-1 internal nodes</li>
                                    <li><strong>Leaf ordering:</strong> Arrangement of data points along the bottom</li>
                                    <li><strong>Total information:</strong> Exponential in number of data points</li>
                                </ul>
                                
                                <h5>Compression Properties:</h5>
                                <div class="white-box">
                                    <p><strong>Distance matrix compression:</strong></p>
                                    <ul class="small-list">
                                        <li>Original: O(n²) pairwise distances</li>
                                        <li>Dendrogram: O(n) tree structure + heights</li>
                                        <li>Information loss: Depends on how well tree represents distances</li>
                                        <li>Quality measure: Cophenetic correlation coefficient</li>
                                    </ul>
                                </div>
                                
                                <h5>Computational Representation:</h5>
                                <ul>
                                    <li><strong>Tree representation:</strong> Parent pointers or adjacency lists</li>
                                    <li><strong>Height storage:</strong> Array of merge heights</li>
                                    <li><strong>Leaf mapping:</strong> Connection between tree leaves and data points</li>
                                    <li><strong>Merge history:</strong> Sequence of cluster combinations</li>
                                </ul>
                            </div>
                        </div>

                        <div class="model-box">
                            <h3>Applications and Use Cases</h3>
                            <p>Dendrograms find applications across diverse domains where hierarchical structure is meaningful.</p>

                            <div class="grid-auto-fit">
                                <div class="azbn-card">
                                    <h4>Biological Sciences</h4>
                                    <ul class="small-list">
                                        <li><strong>Phylogenetic trees:</strong> Evolutionary relationships between species</li>
                                        <li><strong>Gene expression analysis:</strong> Co-expression patterns and pathways</li>
                                        <li><strong>Protein classification:</strong> Structural and functional families</li>
                                        <li><strong>Ecological studies:</strong> Species distribution and habitat relationships</li>
                                        <li><strong>Medical diagnosis:</strong> Disease classification and symptom clustering</li>
                                    </ul>
                                </div>
                                
                                <div class="azbn-card">
                                    <h4>Data Science and Analytics</h4>
                                    <ul class="small-list">
                                        <li><strong>Customer segmentation:</strong> Hierarchical market structure</li>
                                        <li><strong>Product categorization:</strong> Multi-level product taxonomies</li>
                                        <li><strong>Document organization:</strong> Topic hierarchies and document clustering</li>
                                        <li><strong>Recommendation systems:</strong> User and item similarity structures</li>
                                        <li><strong>Anomaly detection:</strong> Identifying outliers at different scales</li>
                                    </ul>
                                </div>
                                
                                <div class="azbn-card">
                                    <h4>Social and Network Analysis</h4>
                                    <ul class="small-list">
                                        <li><strong>Social networks:</strong> Community structure and social hierarchies</li>
                                        <li><strong>Organizational analysis:</strong> Departmental and team relationships</li>
                                        <li><strong>Geographic clustering:</strong> Regional and administrative boundaries</li>
                                        <li><strong>Economic analysis:</strong> Industry sectors and market relationships</li>
                                        <li><strong>Survey analysis:</strong> Response pattern clustering</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <h3>Challenges in Dendrogram Analysis</h3>
                        <p>Working with dendrograms involves several fundamental challenges that affect interpretation and application.</p>

                        <div class="explanation-box">
                            <h4>Key Challenges and Solutions</h4>
                            
                            <h5>Interpretation Challenges:</h5>
                            <ul>
                                <li><strong>Cutting height selection:</strong> No universal rule for optimal cuts</li>
                                <li><strong>Statistical significance:</strong> Distinguishing real structure from noise</li>
                                <li><strong>Scale sensitivity:</strong> Results depend on distance metric and scaling</li>
                                <li><strong>Visualization complexity:</strong> Large trees become difficult to interpret</li>
                            </ul>
                            
                            <h5>Computational Challenges:</h5>
                            <ul>
                                <li><strong>Memory requirements:</strong> O(n²) distance matrix storage</li>
                                <li><strong>Time complexity:</strong> O(n³) for basic algorithms</li>
                                <li><strong>Numerical precision:</strong> Floating-point errors in distance calculations</li>
                                <li><strong>Scalability limits:</strong> Practical limits around 10,000-50,000 points</li>
                            </ul>
                            
                            <h5>Methodological Solutions:</h5>
                            <ul>
                                <li><strong>Multiple cutting criteria:</strong> Use several methods to determine optimal cuts</li>
                                <li><strong>Bootstrap validation:</strong> Assess statistical reliability of branches</li>
                                <li><strong>Interactive exploration:</strong> Dynamic cutting and visualization tools</li>
                                <li><strong>Approximation methods:</strong> Sampling and fast algorithms for large data</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Construction Section -->
                    <div id="construction" class="content-section">
                        <h2>Dendrogram Construction Algorithms</h2>
                        
                        <p>The construction of dendrograms from hierarchical clustering involves specific algorithms that build tree structures while maintaining mathematical properties and computational efficiency. This section covers the fundamental algorithms for converting clustering results into proper dendrogram representations.</p>

                        <div class="algorithm-box">
                            <h3>Basic Construction Algorithm</h3>
                            <p>The standard approach for constructing dendrograms follows the hierarchical clustering merge sequence.</p>

                            <h4>Generic Dendrogram Construction Algorithm</h4>
                            
                            <div class="code-box">
                                <pre><code><strong>function</strong> construct_dendrogram(distance_matrix, linkage_method):
    n = size(distance_matrix, 1)
    
    <span class="comment">// Initialize: Each point is its own cluster</span>
    clusters = [{i} for i = 1 to n]
    tree_nodes = [create_leaf_node(i) for i = 1 to n]
    merge_sequence = []
    
    <span class="comment">// Main construction loop</span>
    <strong>for</strong> step = 1 to n-1:
        <span class="comment">// Find closest pair of clusters</span>
        min_distance = infinity
        merge_i, merge_j = -1, -1
        
        <strong>for</strong> i = 1 to len(clusters):
            <strong>for</strong> j = i+1 to len(clusters):
                d = linkage_distance(clusters[i], clusters[j], linkage_method)
                <strong>if</strong> d &lt; min_distance:
                    min_distance = d
                    merge_i, merge_j = i, j
        
        <span class="comment">// Create new internal node</span>
        new_node = create_internal_node(
            left_child = tree_nodes[merge_i],
            right_child = tree_nodes[merge_j],
            height = min_distance,
            cluster_size = |clusters[merge_i]| + |clusters[merge_j]|
        )
        
        <span class="comment">// Update data structures</span>
        merge_sequence.append((merge_i, merge_j, min_distance, step))
        clusters[merge_i] = clusters[merge_i] ∪ clusters[merge_j]
        clusters.remove(clusters[merge_j])
        tree_nodes[merge_i] = new_node
        tree_nodes.remove(tree_nodes[merge_j])
        
        <span class="comment">// Update distance matrix using Lance-Williams formula</span>
        update_distances(distance_matrix, merge_i, merge_j, linkage_method)
    
    <strong>return</strong> tree_nodes[0], merge_sequence</code></pre>
                            </div>
                            
                            <h5>Key Components:</h5>
                            <ul>
                                <li><strong>Tree node structure:</strong> Parent-child relationships with height information</li>
                                <li><strong>Merge tracking:</strong> Record of which clusters were merged at each step</li>
                                <li><strong>Distance updates:</strong> Efficient recalculation using Lance-Williams formula</li>
                                <li><strong>Height assignment:</strong> Merge distances become node heights</li>
                            </ul>
                        </div>

                        <div class="theorem-box">
                            <h3>Optimized Construction Methods</h3>
                            <p>Several optimizations have been developed to improve the efficiency of dendrogram construction for specific linkage criteria.</p>

                            <h4>Efficient Algorithms for Specific Linkage Methods</h4>
                            
                            <h5>Single Linkage - MST Approach:</h5>
                            <div class="white-box">
                                <p><strong>Algorithm:</strong> Construct minimum spanning tree, then build dendrogram from MST edges</p>
                                <div class="code-box">
                                    <pre><code><strong>function</strong> single_linkage_dendrogram(points):
    <span class="comment">// Build MST using Kruskal's or Prim's algorithm</span>
    mst_edges = minimum_spanning_tree(points)
    
    <span class="comment">// Sort edges by weight (distance)</span>
    sort(mst_edges, key=weight)
    
    <span class="comment">// Build dendrogram by processing edges in order</span>
    <strong>for</strong> edge in mst_edges:
        merge_components_containing(edge.u, edge.v, height=edge.weight)
    
    <strong>return</strong> dendrogram_tree</code></pre>
                                </div>
                                <p><strong>Complexity:</strong> O(n² log n) using efficient MST algorithms</p>
                            </div>
                            
                            <h5>Complete Linkage - CLINK Integration:</h5>
                            <div class="white-box">
                                <p><strong>Approach:</strong> Build dendrogram directly during CLINK execution</p>
                                <p><strong>Advantage:</strong> No separate tree construction phase needed</p>
                                <p><strong>Output:</strong> Compact parent-pointer representation</p>
                            </div>
                            
                            <h5>Average Linkage - UPGMA Tree Building:</h5>
                            <div class="white-box">
                                <p><strong>Method:</strong> Weighted tree construction during clustering</p>
                                <p><strong>Property:</strong> Produces ultrametric trees under molecular clock assumption</p>
                                <p><strong>Application:</strong> Standard method in phylogenetics</p>
                            </div>
                        </div>

                        <div class="tree-structure algorithm-box">
                            <h3>Tree Data Structure Implementation</h3>
                            <p>Efficient dendrogram representation requires careful consideration of data structures and memory layout.</p>

                            <h4>Dendrogram Data Structure Design</h4>
                            
                            <h5>Node Representation:</h5>
                            <div class="code-box">
                                <pre><code><strong>class</strong> DendrogramNode:
    node_id: int              <span class="comment">// Unique identifier</span>
    height: float             <span class="comment">// Merge height/distance</span>
    cluster_size: int         <span class="comment">// Number of leaves in subtree</span>
    
    <span class="comment">// Tree structure</span>
    left_child: DendrogramNode?
    right_child: DendrogramNode?
    parent: DendrogramNode?
    
    <span class="comment">// Data association (for leaf nodes)</span>
    data_index: int?          <span class="comment">// Original data point index</span>
    
    <span class="comment">// Optional metadata</span>
    merge_order: int?         <span class="comment">// Step when this merge occurred</span>
    cluster_id: int?          <span class="comment">// Cluster identifier at some cut</span></code></pre>
                            </div>
                            
                            <h5>Compact Representations:</h5>
                            <ul>
                                <li><strong>Parent array:</strong> parent[i] = parent of node i (SLINK/CLINK format)</li>
                                <li><strong>Merge matrix:</strong> (n-1) × 4 matrix with [node1, node2, distance, size]</li>
                                <li><strong>Newick format:</strong> Parenthetical string representation (phylogenetics)</li>
                                <li><strong>JSON/XML:</strong> Structured text formats for interchange</li>
                            </ul>
                            
                            <h5>Memory Optimization:</h5>
                            <ul>
                                <li><strong>Node pooling:</strong> Preallocate node objects to reduce allocation overhead</li>
                                <li><strong>Compact storage:</strong> Pack multiple small fields into single integers</li>
                                <li><strong>Lazy evaluation:</strong> Compute properties only when needed</li>
                                <li><strong>Reference sharing:</strong> Share immutable data between nodes</li>
                            </ul>
                        </div>

                        <div class="property-box explanation-box">
                            <h3>Handling Special Cases</h3>
                            <p>Dendrogram construction must handle various edge cases and data anomalies gracefully.</p>

                            <h4>Special Case Handling</h4>
                            
                            <h5>Tied Distances:</h5>
                            <div class="white-box">
                                <p><strong>Problem:</strong> Multiple cluster pairs with identical merge distances</p>
                                <p><strong>Solutions:</strong></p>
                                <ul class="small-list">
                                    <li>Lexicographic ordering by cluster indices</li>
                                    <li>Secondary criteria (cluster size, variance)</li>
                                    <li>Random tie-breaking with fixed seed</li>
                                    <li>Report ties in output for user awareness</li>
                                </ul>
                            </div>
                            
                            <h5>Identical Points:</h5>
                            <div class="white-box">
                                <p><strong>Issue:</strong> Multiple data points with zero distance</p>
                                <p><strong>Approaches:</strong></p>
                                <ul class="small-list">
                                    <li>Merge at height 0 (standard approach)</li>
                                    <li>Add small random perturbation (ε-perturbation)</li>
                                    <li>Use arbitrary ordering for identical points</li>
                                    <li>Special handling in visualization</li>
                                </ul>
                            </div>
                            
                            <h5>Non-Monotonic Heights:</h5>
                            <div class="white-box">
                                <p><strong>Occurs in:</strong> Centroid and median linkage methods</p>
                                <p><strong>Detection:</strong> Check for h(child) &gt; h(parent) violations</p>
                                <p><strong>Correction:</strong> Height adjustment to maintain monotonicity</p>
                                <p><strong>Alternative:</strong> Switch to monotonic linkage method</p>
                            </div>
                            
                            <h5>Numerical Precision:</h5>
                            <ul>
                                <li><strong>Floating-point errors:</strong> Use appropriate tolerance for equality tests</li>
                                <li><strong>Large distance ranges:</strong> Consider log-scale or normalization</li>
                                <li><strong>Very small distances:</strong> Avoid underflow in height calculations</li>
                                <li><strong>Precision loss:</strong> Use double precision for intermediate calculations</li>
                            </ul>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Dendrogram Construction Process</h4>
                            <p><strong>Image Description:</strong> A step-by-step animation showing dendrogram construction for 6 data points. Left side shows distance matrix updates at each step with minimum distances highlighted. Right side shows progressive tree building: (1) Initial state with 6 leaf nodes, (2) First merge creating internal node, (3-5) Subsequent merges adding height and structure, (6) Final complete binary tree. Each step annotates the merge distance, cluster sizes, and tree structure changes.</p>
                            <p><em>This demonstrates how hierarchical clustering merge sequence translates to tree structure construction</em></p>
                        </div>

                        <div class="explanation-box">
                            <h3>Validation During Construction</h3>
                            <p>Building robust dendrograms requires validation checks throughout the construction process.</p>

                            <h4>Construction Validation Checks</h4>
                            
                            <h5>Structural Validation:</h5>
                            <ul>
                                <li><strong>Tree completeness:</strong> Ensure all n data points appear as leaves</li>
                                <li><strong>Binary structure:</strong> Verify each internal node has exactly 2 children</li>
                                <li><strong>Height monotonicity:</strong> Check h(child) ≤ h(parent) for all nodes</li>
                                <li><strong>Connectivity:</strong> Verify single connected tree structure</li>
                            </ul>
                            
                            <h5>Mathematical Validation:</h5>
                            <ul>
                                <li><strong>Distance consistency:</strong> Heights match expected linkage distances</li>
                                <li><strong>Cluster size tracking:</strong> Internal node sizes equal sum of children</li>
                                <li><strong>Merge sequence:</strong> Verify correct order of cluster combinations</li>
                                <li><strong>Uniqueness:</strong> Check for duplicate merges or circular references</li>
                            </ul>
                            
                            <h5>Algorithmic Validation:</h5>
                            <ul>
                                <li><strong>Lance-Williams consistency:</strong> Distance updates follow formula exactly</li>
                                <li><strong>Optimization correctness:</strong> Each merge is truly optimal for criterion</li>
                                <li><strong>Numerical stability:</strong> Results are robust to small perturbations</li>
                                <li><strong>Reproducibility:</strong> Identical results for identical inputs</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Heights Section -->
                    <div id="heights" class="content-section">
                        <h2>Height Assignment and Ultrametric Properties</h2>
                        
                        <p>The assignment of heights to internal nodes in dendrograms is fundamental to their interpretation and mathematical properties. Heights encode the dissimilarity at which clusters merge, and their proper assignment ensures the dendrogram accurately represents the clustering process.</p>

                        <h3>Mathematical Foundation of Heights</h3>
                        <p>Height assignment in dendrograms follows specific mathematical rules that maintain consistency with the underlying distance structure and clustering algorithm.</p>

                        <div class="formula-box">
                            <h4>Formal Height Assignment Rules</h4>
                            
                            <h5>Basic Height Function:</h5>
                            <div class="white-box">
                                <p><strong>Definition:</strong> Let h: V → ℝ⁺ be the height function for dendrogram nodes V</p>
                                
                                <p><strong>Leaf nodes:</strong> h(leaf) = 0</p>
                                
                                <p><strong>Internal nodes:</strong> For internal node v created by merging clusters Cᵢ and Cⱼ:</p>
                                <div class="centered-text">
                                    <strong>h(v) = d(Cᵢ, Cⱼ)</strong>
                                </div>
                                <p>where d(Cᵢ, Cⱼ) is the linkage distance between clusters</p>
                            </div>
                            
                            <h5>Monotonicity Constraint:</h5>
                            <div class="white-box">
                                <p><strong>Requirement:</strong> For any internal node v with parent p:</p>
                                <div class="centered-text">
                                    <strong>h(v) ≤ h(p)</strong>
                                </div>
                                <p><strong>Interpretation:</strong> Heights must be non-decreasing toward the root</p>
                                <p><strong>Violation:</strong> Indicates issues with linkage method or data</p>
                            </div>
                            
                            <h5>Ultrametric Property:</h5>
                            <div class="white-box">
                                <p><strong>Definition:</strong> For any three leaves i, j, k with heights hᵢⱼ, hᵢₖ, hⱼₖ of their lowest common ancestors:</p>
                                <div class="centered-text">
                                    <strong>max{hᵢⱼ, hᵢₖ} ≥ hⱼₖ</strong>
                                </div>
                                <p><strong>Strong ultrametric:</strong> Two largest distances are equal</p>
                                <p><strong>Consequence:</strong> Tree distances satisfy triangle inequality strictly</p>
                            </div>
                        </div>

                        <h3>Linkage-Specific Height Interpretations</h3>
                        <p>Different linkage methods produce heights with distinct statistical and geometric interpretations.</p>

                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Linkage Method</th>
                                    <th>Height Formula</th>
                                    <th>Statistical Interpretation</th>
                                    <th>Monotonicity</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Single Linkage</strong></td>
                                    <td>h = min{d(x,y) : x∈Cᵢ, y∈Cⱼ}</td>
                                    <td>Minimum separation distance</td>
                                    <td>Always monotonic</td>
                                </tr>
                                <tr>
                                    <td><strong>Complete Linkage</strong></td>
                                    <td>h = max{d(x,y) : x∈Cᵢ, y∈Cⱼ}</td>
                                    <td>Maximum diameter after merge</td>
                                    <td>Always monotonic</td>
                                </tr>
                                <tr>
                                    <td><strong>Average Linkage</strong></td>
                                    <td>h = Σd(x,y)/(|Cᵢ|×|Cⱼ|)</td>
                                    <td>Average inter-cluster distance</td>
                                    <td>Always monotonic</td>
                                </tr>
                                <tr>
                                    <td><strong>Ward's Method</strong></td>
                                    <td>h = ESS(Cᵢ∪Cⱼ) - ESS(Cᵢ) - ESS(Cⱼ)</td>
                                    <td>Increase in within-cluster variance</td>
                                    <td>Always monotonic</td>
                                </tr>
                                <tr>
                                    <td><strong>Centroid Linkage</strong></td>
                                    <td>h = d(c̄ᵢ, c̄ⱼ)</td>
                                    <td>Distance between cluster centroids</td>
                                    <td>May violate</td>
                                </tr>
                                <tr>
                                    <td><strong>Median Linkage</strong></td>
                                    <td>h = d(mᵢ, mⱼ)</td>
                                    <td>Distance between cluster medians</td>
                                    <td>May violate</td>
                                </tr>
                            </tbody>
                        </table>

                        <h3>Cophenetic Distances</h3>
                        <p>Cophenetic distances quantify how well the dendrogram preserves the original distance structure, providing a key quality measure.</p>

                        <div class="explanation-box">
                            <h4>Cophenetic Distance Analysis</h4>
                            
                            <h5>Definition and Computation:</h5>
                            <div class="white-box">
                                <p><strong>Cophenetic distance:</strong> For leaves i and j, the height of their lowest common ancestor</p>
                                <div class="centered-text">
                                    <strong>c(i,j) = h(LCA(i,j))</strong>
                                </div>
                            </div>
                            
                            <h5>Cophenetic Correlation Coefficient:</h5>
                            <div class="white-box">
                                <p><strong>Formula:</strong> Correlation between original distances D and cophenetic distances C</p>
                                <div class="centered-text">
                                    <strong>r = Σ(dᵢⱼ - d̄)(cᵢⱼ - c̄) / √[Σ(dᵢⱼ - d̄)² Σ(cᵢⱼ - c̄)²]</strong>
                                </div>
                                <p><strong>Interpretation:</strong></p>
                                <ul class="small-list">
                                    <li>r ≈ 1: Excellent fit, dendrogram preserves distances well</li>
                                    <li>r ≈ 0.8: Good fit, acceptable for most applications</li>
                                    <li>r &lt; 0.7: Poor fit, consider different linkage method</li>
                                    <li>r ≈ 0: No relationship, dendrogram is misleading</li>
                                </ul>
                            </div>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Height Assignment Effects</h4>
                            <p><strong>Image Description:</strong> Four-panel comparison showing the same 8-point dataset clustered with different linkage methods. Each panel shows: (1) Original data points in 2D space with cluster boundaries, (2) Corresponding dendrogram with height annotations, (3) Height profile graph showing merge heights vs. merge order. Single linkage shows early low merges then large jumps; complete linkage shows gradual height increases; average linkage shows moderate progression; Ward's method shows statistical height interpretation. Annotations highlight monotonicity and ultrametric properties.</p>
                            <p><em>This illustrates how different linkage criteria produce different height patterns and interpretations</em></p>
                        </div>
                    </div>

                    <!-- Cutting Section -->
                    <div id="cutting" class="content-section">
                        <h2>Dendrogram Cutting Strategies</h2>
                        
                        <p>Extracting meaningful flat clusterings from dendrograms requires sophisticated cutting strategies that balance statistical validity, interpretability, and application requirements. This section explores the mathematical foundations and practical approaches for determining optimal cuts.</p>

                        <h3>Mathematical Framework for Cutting</h3>
                        <p>Dendrogram cutting transforms the hierarchical structure into flat partitions through systematic selection of cut points.</p>

                        <div class="explanation-box">
                            <h4>Formal Cutting Definition</h4>
                            
                            <h5>Cut Definition:</h5>
                            <div class="white-box">
                                <p><strong>Horizontal cut:</strong> A horizontal line at height h that intersects dendrogram branches</p>
                                <p><strong>Resulting clusters:</strong> Connected components below the cut line</p>
                                <p><strong>Mathematical representation:</strong></p>
                                <div class="centered-text">
                                    <strong>P(h) = {C₁, C₂, ..., Cₖ₍ₕ₎}</strong>
                                </div>
                                <p>where Cᵢ are maximal connected components at height h</p>
                            </div>
                        </div>

                        <h3>Optimal Cut Selection Methods</h3>
                        <p>Determining the optimal cutting height requires balancing multiple criteria and often involves statistical testing or optimization procedures.</p>

                        <div class="algorithm-box">
                            <h4>Cut Selection Algorithms</h4>
                            
                            <h5>Gap Statistic Method:</h5>
                            <div class="white-box">
                                <p><strong>Principle:</strong> Find height with largest gap between consecutive merge distances</p>
                                <p><strong>Interpretation:</strong> Large gaps suggest natural cluster boundaries</p>
                                <p><strong>Limitation:</strong> May be sensitive to outliers and noise</p>
                            </div>
                            
                            <h5>Silhouette Optimization:</h5>
                            <div class="white-box">
                                <p><strong>Objective:</strong> Maximize average silhouette coefficient across all cut heights</p>
                                <p><strong>Advantage:</strong> Directly optimizes cluster quality measure</p>
                                <p><strong>Cost:</strong> Requires O(n²) distance computations per candidate height</p>
                            </div>
                            
                            <h5>Inconsistency Method:</h5>
                            <div class="white-box">
                                <p><strong>Concept:</strong> Identify links with heights inconsistent with local neighborhood</p>
                                <p><strong>Inconsistency coefficient:</strong></p>
                                <div class="centered-text">
                                    <strong>I(link) = (h(link) - μ) / σ</strong>
                                </div>
                                <p>where μ, σ are mean and standard deviation of heights in link's neighborhood</p>
                            </div>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Cutting Strategy Comparison</h4>
                            <p><strong>Image Description:</strong> Six-panel visualization comparing different cutting strategies on the same dendrogram. Panels show: (1) Gap statistic method with height gaps annotated, (2) Silhouette optimization with silhouette scores plotted vs. number of clusters, (3) Inconsistency method highlighting inconsistent links, (4) Bootstrap confidence with branch confidence values shown as colors, (5) Dynamic tree cutting showing adaptive height selection, (6) Multi-resolution analysis displaying cluster persistence across scales.</p>
                            <p><em>This illustrates how different cutting strategies produce different cluster solutions and their relative merits</em></p>
                        </div>
                    </div>

                    <!-- Validation Section -->
                    <div id="validation" class="content-section">
                        <h2>Statistical Validation of Dendrograms</h2>
                        
                        <p>Statistical validation provides rigorous methods for assessing the reliability, significance, and quality of dendrogram structures. This section covers bootstrap methods, hypothesis testing, and stability analysis for hierarchical clustering results.</p>

                        <h3>Bootstrap Validation Methods</h3>
                        <p>Bootstrap resampling offers powerful tools for assessing the statistical reliability of dendrogram branches and cluster stability.</p>

                        <div class="explanation-box">
                            <h4>Bootstrap Confidence for Dendrograms</h4>
                            
                            <h5>Basic Bootstrap Procedure:</h5>
                            <div class="white-box">
                                <ol class="small-list">
                                    <li>Generate B bootstrap samples from original data</li>
                                    <li>Construct dendrogram for each bootstrap sample</li>
                                    <li>For each edge, count how often it appears in bootstrap dendrograms</li>
                                    <li>Assign confidence values based on bootstrap frequencies</li>
                                </ol>
                            </div>
                            
                            <h5>Confidence Interpretation:</h5>
                            <div class="white-box">
                                <p><strong>High confidence (&gt; 0.95):</strong> Very stable cluster, appears in almost all bootstrap samples</p>
                                <p><strong>Moderate confidence (0.7-0.95):</strong> Reasonably stable, some sensitivity to sampling</p>
                                <p><strong>Low confidence (&lt; 0.7):</strong> Unstable cluster, may be due to noise or weak signal</p>
                            </div>
                        </div>

                        <h3>Approximately Unbiased (AU) Bootstrap</h3>
                        <p>The AU bootstrap provides more accurate confidence values by correcting for selection bias in hierarchical clustering.</p>

                        <div class="theorem-box">
                            <h4>AU Bootstrap Theory</h4>
                            
                            <h5>Bias Problem:</h5>
                            <div class="white-box">
                                <p><strong>Issue:</strong> Standard bootstrap overestimates confidence for clusters selected by the same procedure</p>
                                <p><strong>Selection bias:</strong> Clusters are chosen to optimize clustering criterion, inflating their apparent stability</p>
                            </div>
                            
                            <h5>AU Correction:</h5>
                            <div class="white-box">
                                <p><strong>Method:</strong> Extrapolate bootstrap probabilities to eliminate selection bias</p>
                                <p><strong>Procedure:</strong> Compute bootstrap probabilities for multiple sample sizes, fit polynomial model, extrapolate to get unbiased estimate</p>
                            </div>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Validation Results Dashboard</h4>
                            <p><strong>Image Description:</strong> Comprehensive validation dashboard with six panels: (1) Original dendrogram with bootstrap confidence values shown as branch colors (red=low, green=high), (2) Cophenetic correlation scatterplot showing original vs. cophenetic distances, (3) Bootstrap probability distribution histogram, (4) AU bootstrap p-values table, (5) Stability curves showing cluster agreement vs. noise level, (6) Gap statistic plot with optimal k selection.</p>
                            <p><em>This provides a complete statistical validation overview for dendrogram reliability assessment</em></p>
                        </div>
                    </div>

                    <!-- Visualization Section -->
                    <div id="visualization" class="content-section">
                        <h2>Dendrogram Visualization and Enhancement</h2>
                        
                        <p>Effective dendrogram visualization requires sophisticated techniques that balance readability, information content, and aesthetic appeal. This section covers advanced visualization methods, interactive techniques, and design principles for communicating hierarchical structure.</p>

                        <h3>Basic Dendrogram Layouts</h3>
                        <p>The fundamental challenge in dendrogram visualization is organizing tree structure in 2D space while maintaining readability and preserving mathematical relationships.</p>

                        <div class="explanation-box">
                            <h4>Standard Layout Algorithms</h4>
                            
                            <h5>Rectangular (Traditional) Layout:</h5>
                            <div class="white-box">
                                <p><strong>Advantages:</strong> Simple, familiar, preserves height relationships</p>
                                <p><strong>Limitations:</strong> Poor space utilization, overlapping labels</p>
                            </div>
                            
                            <h5>Circular (Radial) Layout:</h5>
                            <div class="white-box">
                                <p><strong>Principle:</strong> Arrange leaves around circle, place internal nodes radially</p>
                                <p><strong>Advantages:</strong> Compact, aesthetic, good for large trees</p>
                                <p><strong>Challenges:</strong> Angle spacing, label placement</p>
                            </div>
                            
                            <h5>Force-Directed Layout:</h5>
                            <div class="white-box">
                                <p><strong>Approach:</strong> Use physical simulation to position nodes</p>
                                <p><strong>Forces:</strong> Spring forces between connected nodes, repulsive forces between all pairs</p>
                                <p><strong>Optimization:</strong> Minimize total system energy</p>
                            </div>
                        </div>

                        <h3>Advanced Visualization Techniques</h3>
                        <p>Modern dendrogram visualization incorporates additional information layers and interactive elements to enhance understanding.</p>

                        <div class="explanation-box">
                            <h4>Enhanced Dendrogram Features</h4>
                            
                            <h5>Color-Coded Branches:</h5>
                            <ul class="small-list">
                                <li><strong>Bootstrap confidence:</strong> Color intensity proportional to confidence level</li>
                                <li><strong>Cluster size:</strong> Branch thickness or color indicates subtree size</li>
                                <li><strong>Cluster type:</strong> Different colors for different cluster categories</li>
                                <li><strong>Statistical significance:</strong> Gradient colors for p-values</li>
                            </ul>
                            
                            <h5>Interactive Features:</h5>
                            <ul class="small-list">
                                <li><strong>Dynamic cutting:</strong> Real-time height adjustment with immediate cluster update</li>
                                <li><strong>Hover information:</strong> Detailed tooltips with statistics</li>
                                <li><strong>Coordinated views:</strong> Link with scatter plots and other visualizations</li>
                                <li><strong>Zoom and pan:</strong> Navigation for large trees</li>
                            </ul>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Advanced Dendrogram Gallery</h4>
                            <p><strong>Image Description:</strong> Eight-panel gallery showing different dendrogram visualization techniques: (1) Traditional rectangular layout with bootstrap confidence colors, (2) Circular layout for phylogenetic tree with time scale, (3) Interactive cutting interface with height slider, (4) Multi-scale visualization with overview+detail, (5) Gene expression heatmap with dual dendrograms, (6) 3D dendrogram with height as z-axis, (7) Simplified large-scale tree, (8) Coordinated views with scatter plot.</p>
                            <p><em>This showcases the diversity of dendrogram visualization approaches for different applications and scales</em></p>
                        </div>
                    </div>

                    <!-- Interpretation Section -->
                    <div id="interpretation" class="content-section">
                        <h2>Dendrogram Interpretation and Analysis</h2>
                        
                        <p>Effective dendrogram interpretation requires systematic approaches that combine statistical analysis, domain knowledge, and visual pattern recognition. This section provides comprehensive guidelines for extracting meaningful insights from hierarchical clustering results.</p>

                        <h3>Reading Dendrogram Structure</h3>
                        <p>Understanding the basic elements of dendrogram structure is fundamental to proper interpretation and analysis.</p>

                        <div class="explanation-box">
                            <h4>Systematic Dendrogram Reading</h4>
                            
                            <h5>Structural Elements Analysis:</h5>
                            <div class="white-box">
                                <p><strong>Height patterns:</strong></p>
                                <ul class="small-list">
                                    <li><strong>Uniform heights:</strong> Gradual merging suggests gradual similarity decrease</li>
                                    <li><strong>Large height jumps:</strong> Indicate distinct cluster boundaries</li>
                                    <li><strong>Small height differences:</strong> Suggest similar or uncertain groupings</li>
                                </ul>
                                
                                <p><strong>Branch patterns:</strong></p>
                                <ul class="small-list">
                                    <li><strong>Balanced splits:</strong> Roughly equal-sized subtrees</li>
                                    <li><strong>Imbalanced splits:</strong> One large group with small outlier groups</li>
                                    <li><strong>Deep branches:</strong> Indicate strong substructure</li>
                                </ul>
                            </div>
                            
                            <h5>Common Patterns and Meanings:</h5>
                            <div class="white-box">
                                <p><strong>"Christmas tree" shape:</strong> One dominant cluster with many small outliers</p>
                                <p><strong>Balanced binary tree:</strong> Hierarchical structure with roughly equal splits</p>
                                <p><strong>"Comb" structure:</strong> Sequential splitting, suggests ordered relationships</p>
                                <p><strong>Star-like pattern:</strong> Central cluster with peripheral branches</p>
                            </div>
                        </div>

                        <h3>Domain-Specific Interpretation Guidelines</h3>
                        <p>Different application domains require specialized interpretation approaches that incorporate field-specific knowledge and expectations.</p>

                        <div class="grid-auto-fit">
                            <div class="azbn-card">
                                <h4>Biological Data Interpretation</h4>
                                <h5>Phylogenetic Analysis:</h5>
                                <ul class="small-list">
                                    <li><strong>Monophyletic groups:</strong> All descendants of common ancestor should cluster together</li>
                                    <li><strong>Bootstrap support:</strong> Values &gt; 70% traditionally considered reliable</li>
                                    <li><strong>Branch lengths:</strong> Reflect evolutionary change rates</li>
                                </ul>
                                
                                <h5>Gene Expression:</h5>
                                <ul class="small-list">
                                    <li><strong>Functional coherence:</strong> Co-expressed genes should share biological functions</li>
                                    <li><strong>Pathway enrichment:</strong> Clusters should be enriched for specific pathways</li>
                                </ul>
                            </div>
                            
                            <div class="azbn-card">
                                <h4>Market Research Interpretation</h4>
                                <h5>Customer Segmentation:</h5>
                                <ul class="small-list">
                                    <li><strong>Actionable segments:</strong> Clusters should correspond to distinct marketing strategies</li>
                                    <li><strong>Size balance:</strong> Segments should be large enough to be profitable</li>
                                    <li><strong>Behavioral consistency:</strong> Purchasing patterns should be consistent within clusters</li>
                                </ul>
                            </div>
                        </div>

                        <h3>Systematic Interpretation Workflow</h3>
                        <p>A structured approach to dendrogram interpretation ensures comprehensive analysis and reduces the risk of overlooking important patterns.</p>

                        <div class="algorithm-box">
                            <h4>Comprehensive Interpretation Protocol</h4>
                            
                            <h5>Phase 1: Initial Assessment</h5>
                            <ol class="small-list">
                                <li><strong>Quality check:</strong> Assess cophenetic correlation and other quality metrics</li>
                                <li><strong>Visual inspection:</strong> Examine overall tree structure and patterns</li>
                                <li><strong>Height analysis:</strong> Identify potential cutting points</li>
                                <li><strong>Outlier detection:</strong> Find isolated points or unusual structures</li>
                            </ol>
                            
                            <h5>Phase 2: Statistical Validation</h5>
                            <ol class="small-list">
                                <li><strong>Bootstrap analysis:</strong> Assess cluster stability and significance</li>
                                <li><strong>Permutation tests:</strong> Test against null hypotheses</li>
                                <li><strong>Cross-validation:</strong> Evaluate robustness across samples</li>
                            </ol>
                            
                            <h5>Phase 3: Domain Integration</h5>
                            <ol class="small-list">
                                <li><strong>Expert consultation:</strong> Review results with domain specialists</li>
                                <li><strong>Literature comparison:</strong> Compare with published findings</li>
                                <li><strong>Business relevance:</strong> Assess practical significance</li>
                            </ol>
                        </div>

                        <div class="visualization-placeholder">
                            <h4>Visualization: Interpretation Workflow Dashboard</h4>
                            <p><strong>Image Description:</strong> Multi-panel interpretation workflow dashboard showing: (1) Original dendrogram with quality metrics overlay, (2) Height distribution histogram with gap analysis, (3) Bootstrap confidence heatmap, (4) Statistical significance testing results, (5) Domain-specific validation checklist, (6) Final interpretation summary with key findings and uncertainty estimates.</p>
                            <p><em>This illustrates the comprehensive approach to systematic dendrogram interpretation and validation</em></p>
                        </div>
                    </div>

                    <!-- Interactive Demo Section -->
                    <div id="interactive" class="content-section">
                        <h2>Interactive Dendrogram Exploration</h2>
                        
                        <p>Interactive exploration tools allow users to dynamically investigate dendrogram properties, test different cutting strategies, and understand the relationships between parameters and results.</p>

                        <div class="interactive-demo">
                            <h3>Interactive Dendrogram Construction</h3>
                            <p>Explore how different datasets and parameters affect dendrogram structure.</p>
                            
                            <div class="demo-controls">
                                <div class="control-group">
                                    <h4>Dataset Configuration</h4>
                                    <div class="control-item">
                                        <label><strong>Dataset Type:</strong></label>
                                        <select id="dataset-type">
                                            <option value="gaussian">Gaussian Clusters</option>
                                            <option value="elongated">Elongated Clusters</option>
                                            <option value="nested">Nested Hierarchies</option>
                                            <option value="random">Random Points</option>
                                            <option value="iris">Real Dataset (Iris)</option>
                                        </select>
                                    </div>
                                    <div class="control-item">
                                        <label><strong>Number of Points:</strong></label>
                                        <input type="range" id="num-points" min="20" max="200" value="50">
                                        <span id="num-points-value">50</span>
                                    </div>
                                    <div class="control-item">
                                        <label><strong>Noise Level:</strong></label>
                                        <input type="range" id="noise-level" min="0" max="1" step="0.1" value="0.2">
                                        <span id="noise-level-value">0.2</span>
                                    </div>
                                </div>
                                
                                <div class="control-group">
                                    <h4>Clustering Parameters</h4>
                                    <div class="control-item">
                                        <label><strong>Linkage Method:</strong></label>
                                        <select id="linkage-method">
                                            <option value="single">Single Linkage</option>
                                            <option value="complete">Complete Linkage</option>
                                            <option value="average">Average Linkage</option>
                                            <option value="ward">Ward's Method</option>
                                            <option value="centroid">Centroid Linkage</option>
                                        </select>
                                    </div>
                                    <div class="control-item">
                                        <label><strong>Distance Metric:</strong></label>
                                        <select id="distance-metric">
                                            <option value="euclidean">Euclidean</option>
                                            <option value="manhattan">Manhattan</option>
                                            <option value="cosine">Cosine</option>
                                            <option value="correlation">Correlation</option>
                                        </select>
                                    </div>
                                    <button id="generate-dendrogram" class="demo-button">
                                        Generate Dendrogram
                                    </button>
                                </div>
                            </div>

                            <div id="dendrogram-visualization" class="visualization-container">
                                <div class="visualization-panel">
                                    <h4>Data Points</h4>
                                    <canvas id="data-canvas" width="400" height="300"></canvas>
                                </div>
                                <div class="visualization-panel">
                                    <h4>Dendrogram</h4>
                                    <svg id="dendrogram-svg" width="800" height="600"></svg>
                                </div>
                            </div>
                        </div>

                        <div class="interactive-demo">
                            <h3>Dynamic Cutting Exploration</h3>
                            <p>Investigate how different cutting strategies affect cluster formation and quality.</p>
                            
                            <div class="demo-controls">
                                <h4>Cutting Controls</h4>
                                <div class="control-grid">
                                    <div class="control-item">
                                        <label><strong>Cut Height:</strong></label>
                                        <input type="range" id="cut-height" min="0" max="10" step="0.1" value="3.5">
                                        <span id="cut-height-value">3.5</span>
                                    </div>
                                    <div class="control-item">
                                        <label><strong>Min Cluster Size:</strong></label>
                                        <input type="range" id="min-cluster-size" min="1" max="20" value="3">
                                        <span id="min-cluster-size-value">3</span>
                                    </div>
                                    <div class="control-item">
                                        <label><strong>Max Clusters:</strong></label>
                                        <input type="range" id="max-clusters" min="2" max="15" value="8">
                                        <span id="max-clusters-value">8</span>
                                    </div>
                                </div>
                                
                                <div class="cutting-methods">
                                    <h5>Cutting Method Selection:</h5>
                                    <div class="radio-group">
                                        <label><input type="radio" name="cutting-method" value="height" checked> Fixed Height</label>
                                        <label><input type="radio" name="cutting-method" value="clusters"> Number of Clusters</label>
                                        <label><input type="radio" name="cutting-method" value="gap"> Gap Statistic</label>
                                        <label><input type="radio" name="cutting-method" value="silhouette"> Silhouette Optimization</label>
                                    </div>
                                </div>
                            </div>

                            <div id="cutting-visualization" class="visualization-container">
                                <div class="visualization-panel">
                                    <h4>Dendrogram with Cut Line</h4>
                                    <svg id="cutting-dendrogram-svg" width="800" height="400"></svg>
                                </div>
                                <div class="visualization-panel">
                                    <h4>Clustered Data Points</h4>
                                    <canvas id="clustered-canvas" width="400" height="200"></canvas>
                                </div>
                            </div>

                            <div class="demo-metrics">
                                <h4>Quality Metrics</h4>
                                <div class="metrics-grid">
                                    <div class="metric-item">
                                        <span class="metric-label">Number of Clusters:</span>
                                        <span id="num-clusters" class="metric-value">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Silhouette Score:</span>
                                        <span id="silhouette-score" class="metric-value">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Davies-Bouldin Index:</span>
                                        <span id="davies-bouldin" class="metric-value">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Cophenetic Correlation:</span>
                                        <span id="cophenetic-correlation" class="metric-value">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quiz Section -->
                    <div id="quiz" class="content-section">
                        <h2>Test Your Dendrogram Knowledge</h2>
                        
                        <p>Evaluate your understanding of dendrogram construction, interpretation, validation, and visualization techniques.</p>

                        <div class="enhanced-quiz-question">
                            <h4>Question 1: Mathematical Properties</h4>
                            <p>What is the ultrametric property in dendrograms?</p>
                            <div class="margin-top">
                                <input type="radio" name="q1" value="a" id="q1a">
                                <label for="q1a">All internal nodes have the same height</label><br>
                                <input type="radio" name="q1" value="b" id="q1b">
                                <label for="q1b">The distance between any two leaves equals the height of their lowest common ancestor</label><br>
                                <input type="radio" name="q1" value="c" id="q1c">
                                <label for="q1c">Branch lengths are proportional to evolutionary time</label><br>
                                <input type="radio" name="q1" value="d" id="q1d">
                                <label for="q1d">The tree has perfect binary structure</label><br>
                            </div>
                            <button onclick="checkAnswer(1, 'b')" class="azbn-btn">Check Answer</button>
                            <div id="q1-result" class="margin-top"></div>
                        </div>

                        <div class="enhanced-quiz-question">
                            <h4>Question 2: Height Assignment</h4>
                            <p>In Ward's linkage method, what do the heights in the dendrogram represent?</p>
                            <div class="margin-top">
                                <input type="radio" name="q2" value="a" id="q2a">
                                <label for="q2a">Minimum distance between clusters</label><br>
                                <input type="radio" name="q2" value="b" id="q2b">
                                <label for="q2b">Maximum distance between clusters</label><br>
                                <input type="radio" name="q2" value="c" id="q2c">
                                <label for="q2c">Increase in within-cluster sum of squared errors</label><br>
                                <input type="radio" name="q2" value="d" id="q2d">
                                <label for="q2d">Average distance between cluster centroids</label><br>
                            </div>
                            <button onclick="checkAnswer(2, 'c')" class="azbn-btn">Check Answer</button>
                            <div id="q2-result" class="margin-top"></div>
                        </div>

                        <div class="enhanced-quiz-question">
                            <h4>Question 3: Cophenetic Correlation</h4>
                            <p>A cophenetic correlation coefficient of 0.85 indicates:</p>
                            <div class="margin-top">
                                <input type="radio" name="q3" value="a" id="q3a">
                                <label for="q3a">Excellent preservation of original distances</label><br>
                                <input type="radio" name="q3" value="b" id="q3b">
                                <label for="q3b">Good preservation of original distances</label><br>
                                <input type="radio" name="q3" value="c" id="q3c">
                                <label for="q3c">Poor preservation of original distances</label><br>
                                <input type="radio" name="q3" value="d" id="q3d">
                                <label for="q3d">The dendrogram is invalid</label><br>
                            </div>
                            <button onclick="checkAnswer(3, 'b')" class="azbn-btn">Check Answer</button>
                            <div id="q3-result" class="margin-top"></div>
                        </div>

                        <div class="enhanced-quiz-question">
                            <h4>Question 4: Bootstrap Validation</h4>
                            <p>What does a bootstrap confidence value of 0.65 for a dendrogram branch indicate?</p>
                            <div class="margin-top">
                                <input type="radio" name="q4" value="a" id="q4a">
                                <label for="q4a">Highly stable cluster</label><br>
                                <input type="radio" name="q4" value="b" id="q4b">
                                <label for="q4b">Moderately stable cluster</label><br>
                                <input type="radio" name="q4" value="c" id="q4c">
                                <label for="q4c">Questionable stability requiring additional validation</label><br>
                                <input type="radio" name="q4" value="d" id="q4d">
                                <label for="q4d">The cluster appears in 65% of bootstrap samples</label><br>
                            </div>
                            <button onclick="checkAnswer(4, 'b')" class="azbn-btn">Check Answer</button>
                            <div id="q4-result" class="margin-top"></div>
                        </div>

                        <div class="enhanced-quiz-question">
                            <h4>Question 5: Cutting Strategies</h4>
                            <p>The gap statistic method for determining optimal cuts looks for:</p>
                            <div class="margin-top">
                                <input type="radio" name="q5" value="a" id="q5a">
                                <label for="q5a">The height with maximum silhouette coefficient</label><br>
                                <input type="radio" name="q5" value="b" id="q5b">
                                <label for="q5b">The largest gap between consecutive merge heights</label><br>
                                <input type="radio" name="q5" value="c" id="q5c">
                                <label for="q5c">The height that minimizes within-cluster variance</label><br>
                                <input type="radio" name="q5" value="d" id="q5d">
                                <label for="q5d">The point of maximum curvature in the height function</label><br>
                            </div>
                            <button onclick="checkAnswer(5, 'b')" class="azbn-btn">Check Answer</button>
                            <div id="q5-result" class="margin-top"></div>
                        </div>

                        <div class="quiz-section">
                            <h4>Quiz Score</h4>
                            <p>Correct answers: <span id="quiz-score">0</span> / 5</p>
                            <button onclick="resetQuiz()" class="azbn-btn azbn-secondary">Reset Quiz</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Sub-chapter Navigation -->
    
    <div class="sub-section-nav-footer">
        <div class="sub-nav-buttons">
            <button id="prev-subsection" class="sub-nav-btn prev-btn" style="display: none;">
                <span>← Previous</span>
                <span class="sub-nav-label" id="prev-label"></span>
            </button>
            <button id="next-subsection" class="sub-nav-btn next-btn" style="display: none;">
                <span class="sub-nav-label" id="next-label">Quiz</span>
                <span>Next →</span>
            </button>
        </div>
    </div>

    <!-- Chapter Navigation Footer -->
    <div class="navigation-buttons">
        <a href="/tutorials/clustering/chapter9" class="azbn-btn azbn-secondary" onclick="scrollToTop()">← Chapter 9: Linkage Criteria</a>
        <a href="/tutorials/clustering/chapter11" class="azbn-btn azbn-secondary" onclick="scrollToTop()">Chapter 11: DBSCAN Clustering →</a>
    </div>
</body>
</html>

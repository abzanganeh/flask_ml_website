{% extends "base.html" %}

{% block title %}Search Results{% if query %} for "{{ query }}"{% endif %} - {{ site_title }}{% endblock %}

{% block content %}
<div class="search-results-page">
    <div class="container">
        <!-- Search Header -->
        <div class="search-header">
            <h1 class="search-title">
                {% if query %}
                    Search Results for "{{ query }}"
                {% else %}
                    Search
                {% endif %}
            </h1>
            
            <!-- Search Form -->
            <form action="{{ url_for('search') }}" method="GET" class="search-form-large">
                <div class="search-input-group-large">
                    <input type="text" name="q" placeholder="Search tutorials, projects, blog posts..." 
                           class="search-input-large" value="{{ query }}" autofocus>
                    <button type="submit" class="search-button-large">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
            </form>
            
            {% if query %}
                <p class="search-summary">
                    Found {{ total_results }} result{{ 's' if total_results != 1 else '' }}
                    {% if total_results > 0 %}
                        across {{ (results.tutorials|length > 0)|int + (results.projects|length > 0)|int + (results.blog_posts|length > 0)|int }} section{{ 's' if (results.tutorials|length > 0)|int + (results.projects|length > 0)|int + (results.blog_posts|length > 0)|int != 1 else '' }}
                    {% endif %}
                </p>
            {% endif %}
        </div>

        {% if query %}
            <!-- Search Results -->
            <div class="search-results">
                {% if total_results == 0 %}
                    <!-- No Results -->
                    <div class="no-results">
                        <div class="no-results-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>No results found</h3>
                        <p>Try searching with different keywords or check your spelling.</p>
                        <div class="search-suggestions">
                            <h4>Search suggestions:</h4>
                            <ul>
                                <li>Try broader terms (e.g., "machine learning" instead of "neural networks")</li>
                                <li>Check your spelling</li>
                                <li>Use different keywords</li>
                                <li>Try searching for specific topics like "clustering", "python", or "data science"</li>
                            </ul>
                        </div>
                    </div>
                {% else %}
                    <!-- Tutorials Results -->
                    {% if results.tutorials %}
                        <section class="search-section">
                            <h2 class="search-section-title">
                                <i class="fas fa-book"></i> Tutorials ({{ results.tutorials|length }})
                            </h2>
                            <div class="search-results-grid">
                                {% for tutorial in results.tutorials %}
                                    <div class="search-result-card">
                                        <div class="result-card-header">
                                            <h3 class="result-title">
                                                <a href="{{ url_for('tutorial_dedicated', slug=tutorial.slug) if tutorial.has_dedicated_template else url_for('tutorial_detail', slug=tutorial.slug) }}">
                                                    {{ tutorial.title }}
                                                </a>
                                            </h3>
                                            <span class="result-type tutorial">Tutorial</span>
                                        </div>
                                        <p class="result-description">{{ tutorial.description }}</p>
                                        <div class="result-meta">
                                            <span class="result-category">{{ tutorial.category }}</span>
                                            <span class="result-difficulty {{ tutorial.difficulty }}">{{ tutorial.difficulty|title }}</span>
                                            <span class="result-duration">{{ tutorial.duration }}</span>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </section>
                    {% endif %}

                    <!-- Projects Results -->
                    {% if results.projects %}
                        <section class="search-section">
                            <h2 class="search-section-title">
                                <i class="fas fa-code"></i> Projects ({{ results.projects|length }})
                            </h2>
                            <div class="search-results-grid">
                                {% for project in results.projects %}
                                    <div class="search-result-card">
                                        <div class="result-card-header">
                                            <h3 class="result-title">
                                                <a href="{{ url_for('project_detail', project_name=project.slug) }}">
                                                    {{ project.title }}
                                                </a>
                                            </h3>
                                            <span class="result-type project">Project</span>
                                        </div>
                                        <p class="result-description">{{ project.description }}</p>
                                        <div class="result-meta">
                                            <span class="result-category">{{ project.category }}</span>
                                            {% if project.technology_list %}
                                                <div class="result-tech">
                                                    {% for tech in project.technology_list[:3] %}
                                                        <span class="tech-tag">{{ tech }}</span>
                                                    {% endfor %}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </section>
                    {% endif %}

                    <!-- Blog Posts Results -->
                    {% if results.blog_posts %}
                        <section class="search-section">
                            <h2 class="search-section-title">
                                <i class="fas fa-edit"></i> Blog Posts ({{ results.blog_posts|length }})
                            </h2>
                            <div class="search-results-grid">
                                {% for post in results.blog_posts %}
                                    <div class="search-result-card">
                                        <div class="result-card-header">
                                            <h3 class="result-title">
                                                <a href="{{ url_for('blog_post', slug=post.slug) }}">
                                                    {{ post.title }}
                                                </a>
                                            </h3>
                                            <span class="result-type blog">Blog</span>
                                        </div>
                                        <p class="result-description">{{ post.excerpt }}</p>
                                        <div class="result-meta">
                                            <span class="result-date">{{ post.date.strftime('%B %d, %Y') if post.date else 'Recent' }}</span>
                                            {% if post.category %}
                                                <span class="result-category">{{ post.category }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </section>
                    {% endif %}
                {% endif %}
            </div>
        {% else %}
            <!-- Search Tips -->
            <div class="search-tips">
                <h2>Search Tips</h2>
                <div class="tips-grid">
                    <div class="tip-card">
                        <i class="fas fa-lightbulb"></i>
                        <h3>Use Keywords</h3>
                        <p>Search for specific topics like "clustering", "python", "machine learning", or "data science".</p>
                    </div>
                    <div class="tip-card">
                        <i class="fas fa-filter"></i>
                        <h3>Browse by Category</h3>
                        <p>Explore tutorials by category: Machine Learning, Data Science, or Web Development.</p>
                    </div>
                    <div class="tip-card">
                        <i class="fas fa-tags"></i>
                        <h3>Use Tags</h3>
                        <p>Search for specific technologies like "flask", "pandas", "scikit-learn", or "tensorflow".</p>
                    </div>
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

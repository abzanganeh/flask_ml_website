{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/projects/projects.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/projects/churn-risk-intelligence.css') }}">
{% endblock %}

{% block content %}
<div class="container project-detail churn-project">
    <!-- Project Header -->
    <div class="project-header">
        <div class="project-header-content">
            <div class="project-info">
                <h1 class="project-title">{{ project.title }}</h1>
                <p class="project-description">{{ project.description }}</p>
                
                <div class="project-meta">
                    <span class="project-category">{{ project.category }}</span>
                    <span class="project-status">Completed</span>
                    <span class="project-duration">2 months</span>
                </div>
                
                <div class="project-links">
                    <a href="{{ project.github_url }}" class="btn btn-outline" target="_blank">
                        <i class="fas fa-code"></i> View Code
                    </a>
                    <a href="{{ project.github_url }}/blob/main/README.md" class="btn btn-primary" target="_blank">
                        <i class="fas fa-book"></i> Documentation
                    </a>
                </div>
            </div>
            
            <div class="project-image">
                <img src="{{ project.default_image_url }}" alt="{{ project.title }}" />
            </div>
        </div>
    </div>

    <!-- Business Impact Section -->
    <div class="business-impact">
        <h2><i class="fas fa-chart-line"></i> Business Impact</h2>
        <div class="impact-grid">
            <div class="impact-item">
                <div class="impact-icon"><i class="fas fa-bullseye"></i></div>
                <h3>Problem Solved</h3>
                <p>Customer acquisition costs are 5-25x higher than retention costs. This solution identifies at-risk customers with 84.77% ROC-AUC score (80.62% accuracy), enabling proactive retention campaigns.</p>
            </div>
            <div class="impact-item">
                <div class="impact-icon"><i class="fas fa-dollar-sign"></i></div>
                <h3>Value Delivered</h3>
                <p>Identifies high-risk customers for targeted retention campaigns, reduces revenue loss from customer attrition, and optimizes marketing budget allocation with precision targeting.</p>
            </div>
            <div class="impact-item">
                <div class="impact-icon"><i class="fas fa-chart-bar"></i></div>
                <h3>Key Results</h3>
                <p><strong>84.77% ROC-AUC</strong> with XGBoost (Optuna-optimized), <strong>80.62% accuracy</strong> with Logistic Regression. 16 models trained and evaluated with comprehensive business insights.</p>
            </div>
        </div>
    </div>

    <!-- Model Performance -->
    <div class="model-performance">
        <h2><i class="fas fa-brain"></i> Model Performance</h2>
        <div class="performance-highlights">
            <div class="metric-card">
                <div class="metric-value">84.77%</div>
                <div class="metric-label">Best ROC-AUC</div>
                <div class="metric-model">XGBoost (Optuna)</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">80.62%</div>
                <div class="metric-label">Best Accuracy</div>
                <div class="metric-model">Logistic Regression</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">84.71%</div>
                <div class="metric-label">Best Ensemble</div>
                <div class="metric-model">Stacking Classifier</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">16</div>
                <div class="metric-label">Total Models</div>
                <div class="metric-model">Trained & Evaluated</div>
            </div>
        </div>
        <div class="performance-table">
            <table>
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>ROC-AUC</th>
                        <th>Accuracy</th>
                        <th>Precision</th>
                        <th>Recall</th>
                        <th>Optimization</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="best-model">
                        <td><strong>XGBoost (Optuna)</strong></td>
                        <td><strong>84.77%</strong></td>
                        <td>79.58%</td>
                        <td>65.12%</td>
                        <td>71.23%</td>
                        <td><strong>Optuna</strong></td>
                    </tr>
                    <tr class="best-model">
                        <td><strong>Stacking Classifier</strong></td>
                        <td><strong>84.71%</strong></td>
                        <td>79.45%</td>
                        <td>64.89%</td>
                        <td>72.15%</td>
                        <td><strong>Ensemble</strong></td>
                    </tr>
                    <tr>
                        <td>Logistic Regression</td>
                        <td>83.12%</td>
                        <td><strong>80.62%</strong></td>
                        <td>66.45%</td>
                        <td>68.32%</td>
                        <td>Standard</td>
                    </tr>
                    <tr>
                        <td>Random Forest (Optuna)</td>
                        <td>83.89%</td>
                        <td>79.12%</td>
                        <td><strong>66.78%</strong></td>
                        <td>69.45%</td>
                        <td><strong>Optuna</strong></td>
                    </tr>
                    <tr>
                        <td>KNN + SMOTE</td>
                        <td>81.23%</td>
                        <td>75.34%</td>
                        <td>58.92%</td>
                        <td><strong>77.27%</strong></td>
                        <td>SMOTE</td>
                    </tr>
                    <tr>
                        <td>Gradient Boosting</td>
                        <td>83.45%</td>
                        <td>78.67%</td>
                        <td>63.21%</td>
                        <td>70.89%</td>
                        <td>Standard</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="model-portfolio-info">
            <p><strong>Model Portfolio:</strong> 16 machine learning models including Logistic Regression, KNN, Random Forest, Gradient Boosting, XGBoost, and ensemble methods (Stacking, Voting). Both regular and SMOTE variants trained with Optuna hyperparameter optimization.</p>
        </div>
    </div>

    <!-- Technical Architecture -->
    <div class="technical-architecture">
        <h2><i class="fas fa-cogs"></i> Technical Architecture</h2>
        <div class="architecture-steps">
            <div class="step">
                <div class="step-number">1</div>
                <h3>Data Preprocessing</h3>
                <p>Missing value imputation, categorical encoding, feature scaling, and data leakage detection. Modular design with separation of concerns.</p>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <h3>Feature Engineering</h3>
                <p>One-hot encoding, data leakage detection, and train-test splitting with stratification. Automated pipeline from data loading to model deployment.</p>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <h3>Model Development</h3>
                <p>16 machine learning models: Logistic Regression, KNN, Random Forest, Gradient Boosting, XGBoost. Both regular and SMOTE variants.</p>
            </div>
            <div class="step">
                <div class="step-number">4</div>
                <h3>Hyperparameter Optimization</h3>
                <p>Optuna integration for Bayesian optimization. Automated tuning for XGBoost and Random Forest with cross-validation for reliable performance estimation.</p>
            </div>
            <div class="step">
                <div class="step-number">5</div>
                <h3>Ensemble Learning</h3>
                <p>Stacking Classifier with optimized base models and Voting Classifier for robust predictions. Meta-learner optimization for improved performance.</p>
            </div>
            <div class="step">
                <div class="step-number">6</div>
                <h3>Model Interpretability</h3>
                <p>SHAP values for feature importance analysis and individual prediction explanations. Business-friendly insights generation.</p>
            </div>
            <div class="step">
                <div class="step-number">7</div>
                <h3>Comprehensive Evaluation</h3>
                <p>Multiple metrics: ROC-AUC, PR-AUC, Accuracy, Precision, Recall, F1-Score. Advanced visualizations: ROC curves, Precision-Recall curves, heatmaps, interactive Plotly dashboards.</p>
            </div>
        </div>
    </div>

    <!-- Advanced Features Section -->
    <div class="advanced-features">
        <h2><i class="fas fa-rocket"></i> Advanced Features</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-magic"></i></div>
                <h3>Optuna Optimization</h3>
                <p>Bayesian hyperparameter optimization for XGBoost and Random Forest. Automated tuning with cross-validation for reliable performance estimation.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-layer-group"></i></div>
                <h3>Ensemble Methods</h3>
                <p>Stacking Classifier with optimized base models achieving 84.71% ROC-AUC. Voting Classifier for robust predictions across multiple scenarios.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-lightbulb"></i></div>
                <h3>SHAP Interpretability</h3>
                <p>SHAP values provide feature importance analysis and individual prediction explanations. Generate actionable, business-friendly insights.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-chart-pie"></i></div>
                <h3>Interactive Dashboards</h3>
                <p>Plotly dashboards with ROC curves, Precision-Recall curves, heatmaps, and comprehensive business intelligence reports.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-balance-scale"></i></div>
                <h3>Class Imbalance Handling</h3>
                <p>SMOTE implementation for balanced training. Models trained on both balanced and imbalanced data for comprehensive comparison.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-industry"></i></div>
                <h3>Production-Ready</h3>
                <p>Automated pipeline with comprehensive error handling, logging, and validation. End-to-end automation from data loading to model deployment.</p>
            </div>
        </div>
    </div>

    <!-- Code Integration -->
    <div class="code-integration">
        <h2><i class="fas fa-code"></i> Key Code Components</h2>
        
        <div class="code-section">
            <h3>Main Pipeline Orchestrator</h3>
            <div class="code-embed">
                <script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fabzanganeh%2Fchurn_risk_intelligence%2Fblob%2Fmain%2Fsrc%2Fmain.py&style=default&type=code&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on"></script>
            </div>
        </div>

        <div class="code-section">
            <h3>Model Training Pipeline</h3>
            <div class="code-embed">
                <script src="https://emgithub.com/embed-v2.js?target=https%3A%2F%2Fgithub.com%2Fabzanganeh%2Fchurn_risk_intelligence%2Fblob%2Fmain%2Fsrc%2Fmodel_training.py&style=default&type=code&showBorder=on&showLineNumbers=on&showFileMeta=on&showCopy=on"></script>
            </div>
        </div>
    </div>

    <!-- Dataset Information -->
    <div class="dataset-info">
        <h2><i class="fas fa-database"></i> Dataset Information</h2>
        <div class="dataset-details">
            <div class="dataset-stat">
                <h3>Source</h3>
                <p>Telco Customer Churn Dataset</p>
            </div>
            <div class="dataset-stat">
                <h3>Size</h3>
                <p>7,043 customers Ã— 21 features</p>
            </div>
            <div class="dataset-stat">
                <h3>Target</h3>
                <p>Customer churn (Yes/No)</p>
            </div>
            <div class="dataset-stat">
                <h3>Class Distribution</h3>
                <p>26.5% churn rate (imbalanced dataset)</p>
            </div>
        </div>
        
        <div class="feature-categories">
            <h3>Feature Categories</h3>
            <div class="feature-grid">
                <div class="feature-category">
                    <h4>Demographics</h4>
                    <p>Gender, age range, partner/dependent status</p>
                </div>
                <div class="feature-category">
                    <h4>Account Information</h4>
                    <p>Contract type, payment method, tenure, billing preferences</p>
                </div>
                <div class="feature-category">
                    <h4>Services</h4>
                    <p>Phone, internet, security, backup, streaming services</p>
                </div>
                <div class="feature-category">
                    <h4>Financial</h4>
                    <p>Monthly charges, total charges</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Business Recommendations -->
    <div class="business-recommendations">
        <h2><i class="fas fa-lightbulb"></i> Business Recommendations</h2>
        
        <div class="recommendation-section">
            <h3>For Maximum Churn Detection</h3>
            <ul>
                <li><strong>Use KNN + SMOTE model</strong> for maximum churn detection (77.27% recall)</li>
                <li>Implement comprehensive retention campaigns for all flagged customers</li>
                <li>Focus on customers with fiber optic internet and month-to-month contracts</li>
                <li>Best for high-value customer businesses where missing churners is costly</li>
            </ul>
        </div>

        <div class="recommendation-section">
            <h3>For Optimal Performance</h3>
            <ul>
                <li><strong>Use XGBoost (Optuna-optimized)</strong> for best overall performance (84.77% ROC-AUC)</li>
                <li>Leverage SHAP values for understanding key churn drivers</li>
                <li>Use Stacking Classifier (84.71% ROC-AUC) for robust ensemble predictions</li>
                <li>Ideal for balanced business needs requiring both precision and recall</li>
            </ul>
        </div>

        <div class="recommendation-section">
            <h3>For Cost-Conscious Operations</h3>
            <ul>
                <li><strong>Use Logistic Regression model</strong> for efficient targeting (80.62% accuracy, 66.45% precision)</li>
                <li><strong>Use Random Forest (Optuna)</strong> for highest precision (66.78%)</li>
                <li>Prioritize customers with electronic check payments and high monthly charges</li>
                <li>Develop automated retention workflows for scalability</li>
            </ul>
        </div>

        <div class="risk-factors">
            <h3>Key Risk Factors to Monitor</h3>
            <div class="risk-grid">
                <div class="risk-item">
                    <h4>Contract Type</h4>
                    <p>Month-to-month contracts show highest churn rates</p>
                </div>
                <div class="risk-item">
                    <h4>Internet Service</h4>
                    <p>Fiber optic users demonstrate elevated churn risk</p>
                </div>
                <div class="risk-item">
                    <h4>Payment Method</h4>
                    <p>Electronic check payments correlate with increased churn</p>
                </div>
                <div class="risk-item">
                    <h4>Tenure</h4>
                    <p>New customers (&lt; 6 months) require attention</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Technology Stack -->
    <div class="technology-stack">
        <h2><i class="fas fa-tools"></i> Technology Stack</h2>
        <div class="tech-grid">
            {% for tech in project.technology_list %}
            <span class="tech-badge">{{ tech }}</span>
            {% endfor %}
        </div>
    </div>

    <!-- Back Navigation -->
    <div class="back-navigation">
        <a href="{{ url_for('projects') }}" class="btn btn-outline">
            <i class="fas fa-arrow-left"></i> Back to Projects
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Add any project-specific JavaScript here
document.addEventListener('DOMContentLoaded', function() {
    // Initialize any interactive elements
    console.log('Churn Risk Intelligence project page loaded');
});
</script>
{% endblock %}
